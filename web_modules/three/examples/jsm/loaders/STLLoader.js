import{Loader as t,FileLoader as e,BufferGeometry as r,BufferAttribute as n,Float32BufferAttribute as o,LoaderUtils as a,Vector3 as i}from"../../../../three.js";var s=function(e){t.call(this,e)};s.prototype=Object.assign(Object.create(t.prototype),{constructor:s,load:function(t,r,n,o){var a=this,i=new e(a.manager);i.setPath(a.path),i.setResponseType("arraybuffer"),i.load(t,(function(t){try{r(a.parse(t))}catch(t){o&&o(t)}}),n,o)},parse:function(t){function e(t,e,r){for(var n=0,o=t.length;n<o;n++)if(t[n]!==e.getUint8(r+n,!1))return!1;return!0}var s,l=function(t){if("string"==typeof t){for(var e=new Uint8Array(t.length),r=0;r<t.length;r++)e[r]=255&t.charCodeAt(r);return e.buffer||e}return t}(t);return function(t){var r;if(50,84+50*(r=new DataView(t)).getUint32(80,!0)===r.byteLength)return!0;for(var n=[115,111,108,105,100],o=0;o<5;o++)if(e(n,r,o))return!1;return!0}(l)?function(t){for(var e,o,a,i,s,l,f,u,g=new DataView(t),c=g.getUint32(80,!0),p=!1,h=0;h<70;h++)1129270351==g.getUint32(h,!1)&&82==g.getUint8(h+4)&&61==g.getUint8(h+5)&&(p=!0,i=new Float32Array(3*c*3),s=g.getUint8(h+6)/255,l=g.getUint8(h+7)/255,f=g.getUint8(h+8)/255,u=g.getUint8(h+9)/255);for(var w=new r,v=new Float32Array(3*c*3),d=new Float32Array(3*c*3),y=0;y<c;y++){var F=84+50*y,U=g.getFloat32(F,!0),b=g.getFloat32(F+4,!0),m=g.getFloat32(F+8,!0);if(p){var x=g.getUint16(F+48,!0);0==(32768&x)?(e=(31&x)/31,o=(x>>5&31)/31,a=(x>>10&31)/31):(e=s,o=l,a=f)}for(var A=1;A<=3;A++){var E=F+12*A,S=3*y*3+3*(A-1);v[S]=g.getFloat32(E,!0),v[S+1]=g.getFloat32(E+4,!0),v[S+2]=g.getFloat32(E+8,!0),d[S]=U,d[S+1]=b,d[S+2]=m,p&&(i[S]=e,i[S+1]=o,i[S+2]=a)}}return w.setAttribute("position",new n(v,3)),w.setAttribute("normal",new n(d,3)),p&&(w.setAttribute("color",new n(i,3)),w.hasColors=!0,w.alpha=u),w}(l):function(t){for(var e,n=new r,a=/solid([\s\S]*?)endsolid/g,s=/facet([\s\S]*?)endfacet/g,l=0,f=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,u=new RegExp("vertex"+f+f+f,"g"),g=new RegExp("normal"+f+f+f,"g"),c=[],p=[],h=new i,w=0,v=0,d=0;null!==(e=a.exec(t));){v=d;for(var y=e[0];null!==(e=s.exec(y));){for(var F=0,U=0,b=e[0];null!==(e=g.exec(b));)h.x=parseFloat(e[1]),h.y=parseFloat(e[2]),h.z=parseFloat(e[3]),U++;for(;null!==(e=u.exec(b));)c.push(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])),p.push(h.x,h.y,h.z),F++,d++;1!==U&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+l),3!==F&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+l),l++}var m=v,x=d-v;n.addGroup(m,x,w),w++}return n.setAttribute("position",new o(c,3)),n.setAttribute("normal",new o(p,3)),n}("string"!=typeof(s=t)?a.decodeText(new Uint8Array(s)):s)}});export{s as STLLoader};
//# sourceMappingURL=STLLoader.js.map
