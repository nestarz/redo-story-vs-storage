import{Matrix3 as r,Geometry as e,Vector3 as t}from"../../../../three.js";var o,a,n=function(){};n.prototype={constructor:n,parse:(o=new t,a=new r,function(r,t){void 0===t&&(t={});var n=void 0!==t.binary&&t.binary,i=[],l=0;if(r.traverse((function(r){if(r.isMesh){var t=r.geometry;t.isBufferGeometry&&(t=(new e).fromBufferGeometry(t)),t.isGeometry&&(l+=t.faces.length,i.push({geometry:t,matrixWorld:r.matrixWorld}))}})),n){var y=80,f=new ArrayBuffer(2*l+3*l*4*4+80+4);(M=new DataView(f)).setUint32(y,l,!0),y+=4;for(var s=0,m=i.length;s<m;s++){var p=(w=i[s]).geometry.vertices,c=w.geometry.faces,x=w.matrixWorld;a.getNormalMatrix(x);for(var v=0,d=c.length;v<d;v++){var g=c[v];o.copy(g.normal).applyMatrix3(a).normalize(),M.setFloat32(y,o.x,!0),y+=4,M.setFloat32(y,o.y,!0),y+=4,M.setFloat32(y,o.z,!0),y+=4;for(var u=[g.a,g.b,g.c],h=0;h<3;h++)o.copy(p[u[h]]).applyMatrix4(x),M.setFloat32(y,o.x,!0),y+=4,M.setFloat32(y,o.y,!0),y+=4,M.setFloat32(y,o.z,!0),y+=4;M.setUint16(y,0,!0),y+=2}}return M}var M="";for(M+="solid exported\n",s=0,m=i.length;s<m;s++){var w;for(p=(w=i[s]).geometry.vertices,c=w.geometry.faces,x=w.matrixWorld,a.getNormalMatrix(x),v=0,d=c.length;v<d;v++){for(g=c[v],o.copy(g.normal).applyMatrix3(a).normalize(),M+="\tfacet normal "+o.x+" "+o.y+" "+o.z+"\n",M+="\t\touter loop\n",u=[g.a,g.b,g.c],h=0;h<3;h++)o.copy(p[u[h]]).applyMatrix4(x),M+="\t\t\tvertex "+o.x+" "+o.y+" "+o.z+"\n";M+="\t\tendloop\n",M+="\tendfacet\n"}}return M+="endsolid exported\n"})};export{n as STLExporter};
//# sourceMappingURL=STLExporter.js.map
